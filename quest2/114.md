##### 오류 시나리오: MariaDB 패키지를 삭제했는데도 설정 파일이 남아있다?#####

**1) MariaDB 설치**

```bash
sudo apt install -y mariadb-server
```

```tech
apt
```

**2) MariaDB 접속**

```bash
sudo mysql -s
```

```tech
mysql
```

**3) school 데이터베이스 생성**

```bash
CREATE DATABASE school;
```

```tech
mysql
```

**4) school 데이터베이스 사용**

```bash
USE school;
```

```tech
mysql
```

**5) students 테이블 생성**

```bash
CREATE TABLE students (id INT PRIMARY KEY AUTO_INCREMENT, name VARCHAR(50), age INT);
```

```tech
mysql
```

**6) 데이터 삽입**

```bash
INSERT INTO students (name, age) VALUES ('Alice', 20), ('Bob', 22);
```

```tech
mysql
```

**7) 데이터 조회**

```bash
SELECT * FROM students;
```

```tech
mysql
```

**8) MariaDB 종료**

```bash
EXIT;
```

```tech
mysql
```

**9) 자동 설치된 의존성 패키지들 확인**

* 의존성 패키지: 패키지가 정상적으로 동작하기 위해 반드시 함께 설치되어야 하는 패키지

```bash
apt-mark showauto | grep -i mariadb
```

```tech
apt-mark, grep
```

**10) MariaDB 패키지 설정 파일까지 모두 삭제**

* purge는 명시한 mariadb-server 패키지와 설정 파일을 삭제합니다.

```bash
sudo apt purge -y mariadb-server
```

```tech
apt
```

**11) 의존성 패키지 삭제**

* autoremove는 더 이상 사용되지 않는 자동 설치된 의존성 패키지를 정리합니다.

```bash
sudo apt autoremove -y
```

```tech
apt
```

**12) 패키지 캐시 정리**

* clean은 다운로드된 패키지 캐시를 정리합니다.

```bash
sudo apt clean
```

```tech
apt
```

**13) 패키지 삭제 여부 확인**

* list --installed는 설치된 실행 가능한 패키지들을 확인 가능합니다.

```bash
apt list --installed | grep -i mariadb
```

```tech
apt, grep
```

**14) 설정 파일까지 모두 삭제되었는지 확인**

* dpkg -l은 설정 파일 존재 여부까지 확인 가능합니다.
* 의존성 패키지들이 rc 형태로 남아있는 것을 확인할 수 있습니다. 
* rc: 패키지는 삭제되었으나, 설정 파일이 남아 있음

```bash
dpkg -l | grep -i mariadb
```

```tech
dpkg, grep
```

**15) rc 상태인 패키지 목록을 변수에 저장**

* 설정 파일만 남아 있는 패키지 이름을 추출해서 config_pkgs 변수에 저장합니다.

```bash
config_pkgs=$(dpkg -l | grep -i mariadb | awk '{print $2}')
```

```tech
dpkg, grep, awk
```

**16) 저장된 패키지 이름 확인**

```bash
echo $config_pkgs
```

```tech
echo
```

**17) 삭제 방법 1: 남아 있는 의존성 패키지들의 설정 파일 제거**

* purge에 패키지명을 명시해주면, 해당 패키지들의 설정 파일까지 제거합니다.
* 삭제 도중 /var/lib/mysql, 즉 데이터 디렉터리까지 모두 삭제할 것인지 묻는 창이 나타납니다. 데이터까지 모두 삭제하려면 YES, 그렇지 않다면 NO를 눌러 진행합니다.

```bash
sudo apt purge -y $config_pkgs
```

```tech
apt
```

**18) 모두 삭제되었는지 최종 확인**

```bash
dpkg -l | grep -i mariadb
```

```tech
dpkg, grep
```

**19) MariaDB 재설치**

```bash
sudo apt install -y mariadb-server
```

```tech
apt
```

**20) 삭제 방법 2: 패키지와 의존성 패키지 설정파일까지 한번에 삭제**

* purge와 autoremove를 같이 사용하면 명시한 패키지와 의존성 패키지들의 모든 관련 요소를 삭제할 수 있습니다.
* 역시 삭제 도중 /var/lib/mysql, 즉 데이터 디렉터리까지 모두 삭제할 것인지 묻는 창이 나타납니다. 데이터까지 모두 삭제하려면 YES, 그렇지 않다면 NO를 눌러 진행합니다.

```bash
sudo apt purge --auto-remove -y mariadb-server
```

```tech
apt
```

**21) 모두 삭제되었는지 재확인**

```bash
dpkg -l | grep -i mariadb
```

```tech
dpkg, grep
```